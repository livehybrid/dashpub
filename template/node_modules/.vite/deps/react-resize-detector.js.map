{
  "version": 3,
  "sources": ["../../react-resize-detector/src/utils.ts", "../../react-resize-detector/src/useResizeDetector.ts"],
  "sourcesContent": ["import * as React from 'react';\nimport debounce from 'lodash/debounce';\nimport throttle from 'lodash/throttle';\nimport type { DebouncedFunc } from 'lodash';\n\nimport { OnRefChangeType, Props } from './types';\n\nexport type PatchedResizeObserverCallback = DebouncedFunc<ResizeObserverCallback> | ResizeObserverCallback;\n\n/**\n * Wraps the resize callback with a lodash debounce / throttle based on the refresh mode\n */\nexport const patchResizeCallback = (\n  resizeCallback: ResizeObserverCallback,\n  refreshMode: Props['refreshMode'],\n  refreshRate: Props['refreshRate'],\n  refreshOptions: Props['refreshOptions']\n): PatchedResizeObserverCallback => {\n  switch (refreshMode) {\n    case 'debounce':\n      return debounce(resizeCallback, refreshRate, refreshOptions);\n    case 'throttle':\n      return throttle(resizeCallback, refreshRate, refreshOptions);\n    default:\n      return resizeCallback;\n  }\n};\n\n/**\n * A custom hook that converts a callback to a ref to avoid triggering re-renders when passed as a\n * prop or avoid re-executing effects when passed as a dependency\n */\nexport const useCallbackRef =\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  <T extends (...args: any[]) => any>(callback: T | undefined): T => {\n    const callbackRef = React.useRef(callback);\n\n    React.useEffect(() => {\n      callbackRef.current = callback;\n    });\n\n    return React.useMemo(() => ((...args) => callbackRef.current?.(...args)) as T, []);\n  };\n\n/** `useRef` hook doesn't handle conditional rendering or dynamic ref changes.\n * This hook creates a proxy that ensures that `refElement` is updated whenever the ref is changed. */\nexport const useRefProxy =\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  <T extends HTMLElement = any>(targetRef: React.MutableRefObject<T | null> | undefined) => {\n    // we are going to use this ref to store the last element that was passed to the hook\n    const [refElement, setRefElement] = React.useState<T | null>(targetRef?.current || null);\n\n    // if targetRef is passed, we need to update the refElement\n    // we have to use setTimeout because ref get assigned after the hook is called\n    // in the future releases we are going to remove targetRef and force users to use ref returned by the hook\n    if (targetRef) {\n      setTimeout(() => {\n        if (targetRef.current !== refElement) {\n          setRefElement(targetRef.current);\n        }\n      }, 0);\n    }\n\n    // this is a memo that will be called every time the ref is changed\n    // This proxy will properly call setState either when the ref is called as a function or when `.current` is set\n    // we call setState inside to trigger rerender\n    const refProxy: OnRefChangeType<T> = React.useMemo(\n      () =>\n        new Proxy(\n          node => {\n            if (node !== refElement) {\n              setRefElement(node);\n            }\n          },\n          {\n            get(target, prop) {\n              if (prop === 'current') {\n                return refElement;\n              }\n              return target[prop];\n            },\n            set(target, prop, value) {\n              if (prop === 'current') {\n                setRefElement(value);\n              } else {\n                target[prop] = value;\n              }\n              return true;\n            }\n          }\n        ),\n      [refElement]\n    );\n\n    return { refProxy, refElement, setRefElement };\n  };\n\n/** Calculates the dimensions of the element based on the current box model.\n * @see https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/The_box_model\n */\nexport const getDimensions = (entry: ResizeObserverEntry, box: ResizeObserverBoxOptions | undefined) => {\n  // Value\t          Border\t  Padding\t  Inner Content\n  // ---------------------------------------------------\n  // 'border-box'\t    Yes\t      Yes\t      Yes\n  // 'content-box'\t  No\t      No\t      Yes\n  //  undefined       No\t      No?\t      Yes\n\n  if (box === 'border-box') {\n    return {\n      width: entry.borderBoxSize[0].inlineSize,\n      height: entry.borderBoxSize[0].blockSize\n    };\n  }\n\n  if (box === 'content-box') {\n    return {\n      width: entry.contentBoxSize[0].inlineSize,\n      height: entry.contentBoxSize[0].blockSize\n    };\n  }\n\n  return {\n    width: entry.contentRect.width,\n    height: entry.contentRect.height\n  };\n};\n", "import { useEffect, useState, useRef, useCallback } from 'react';\nimport type { DebouncedFunc } from 'lodash';\n\nimport { getDimensions, patchResizeCallback, useCallbackRef, useRefProxy } from './utils';\n\nimport type { Dimensions, UseResizeDetectorReturn, useResizeDetectorProps } from './types';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction useResizeDetector<T extends HTMLElement = any>({\n  skipOnMount = false,\n  refreshMode,\n  refreshRate = 1000,\n  refreshOptions,\n  handleWidth = true,\n  handleHeight = true,\n  targetRef,\n  observerOptions,\n  onResize\n}: useResizeDetectorProps<T> = {}): UseResizeDetectorReturn<T> {\n  // If `skipOnMount` is enabled, skip the first resize event\n  const skipResize = useRef<boolean>(skipOnMount);\n\n  // Wrap the `onResize` callback with a ref to avoid re-renders\n  const onResizeRef = useCallbackRef(onResize);\n\n  const [size, setSize] = useState<Dimensions>({\n    width: undefined,\n    height: undefined\n  });\n\n  // Create a proxy ref to handle conditional rendering and dynamic ref changes of the target element\n  const { refProxy, refElement } = useRefProxy<T>(targetRef);\n\n  const { box } = observerOptions || {};\n\n  const resizeCallback: ResizeObserverCallback = useCallback(\n    (entries: ResizeObserverEntry[]) => {\n      if (!handleWidth && !handleHeight) return;\n\n      if (skipResize.current) {\n        skipResize.current = false;\n        return;\n      }\n\n      // Only update the size if one of the observed dimensions has changed\n      const shouldSetSize = (prevSize: Dimensions, nextSize: Dimensions) =>\n        (handleWidth && prevSize.width !== nextSize.width) || (handleHeight && prevSize.height !== nextSize.height);\n\n      entries.forEach(entry => {\n        const dimensions = getDimensions(entry, box);\n        setSize(prevSize => {\n          if (!shouldSetSize(prevSize, dimensions)) return prevSize;\n          onResizeRef?.({\n            width: dimensions.width,\n            height: dimensions.height,\n            entry\n          });\n          return dimensions;\n        });\n      });\n    },\n    [handleWidth, handleHeight, skipResize, box]\n  );\n\n  // Throttle/Debounce the resize event if refreshMode is configured\n  const resizeHandler = useCallback(patchResizeCallback(resizeCallback, refreshMode, refreshRate, refreshOptions), [\n    resizeCallback,\n    refreshMode,\n    refreshRate,\n    refreshOptions\n  ]);\n\n  // Attach ResizeObserver to the element\n  useEffect(() => {\n    let resizeObserver: ResizeObserver | undefined;\n    if (refElement) {\n      resizeObserver = new window.ResizeObserver(resizeHandler);\n      resizeObserver.observe(refElement, observerOptions);\n    }\n    // If refElement is not available, reset the size\n    else if (size.width || size.height) {\n      onResizeRef?.({\n        width: null,\n        height: null,\n        entry: null\n      });\n      setSize({ width: undefined, height: undefined });\n    }\n\n    // Disconnect the ResizeObserver when the component is unmounted\n    return () => {\n      resizeObserver?.disconnect?.();\n      (resizeHandler as DebouncedFunc<ResizeObserverCallback>).cancel?.();\n    };\n  }, [resizeHandler, refElement]);\n\n  return { ref: refProxy, ...size };\n}\n\nexport default useResizeDetector;\n"],
  "mappings": "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",
  "names": ["debounce", "throttle"]
}
